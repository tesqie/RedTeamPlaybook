# Internal Windows Penetration Testing Checklist

## Table of Contents

1. [Information Gathering](#information-gathering)
2. [Initial Enumeration](#initial-enumeration)
3. [Credential Testing](#credential-testing)
4. [Local Enumeration](#local-enumeration)
5. [Privilege Escalation](#privilege-escalation)
6. [Network Attacks](#network-attacks)
7. [Post-Exploitation](#post-exploitation)
8. [Data Exfiltration](#data-exfiltration)
9. [Cleanup](#cleanup)
10. [Reporting](#reporting)

---

## Information Gathering

- [ ] Gather basic network topology information.
- [ ] List all active IP addresses in the network.
- [ ] Identify target Windows machines.

## Initial Enumeration

### SMB Enumeration

- [ ] Enumerate SMB shares.
- [ ] Check for SMB null session.
- [ ] Enumerate users via SMB.

### DNS Enumeration

- [ ] DNS zone transfer.
- [ ] Enumerate DNS records.

### Service Enumeration

- [ ] Enumerate running services with Nmap.
- [ ] Check for vulnerable services.

---

## Credential Testing

- [ ] Brute-force SMB accounts.
- [ ] Check for default credentials on services.
- [ ] Utilize known credentials (if any).

## Local Enumeration

- [ ] Check for misconfigured services.
- [ ] Enumerate local users and groups.
- [ ] Check registry for sensitive info.

## Privilege Escalation

### Windows-specific checks

- [ ] Check for unpatched vulnerabilities.
- [ ] Test for AlwaysInstallElevated registry key.
- [ ] Check permissions on service executables.

### Common Escalation Techniques

- [ ] Kernel exploits.
- [ ] Token impersonation.

---

## Network Attacks

### LLMNR/NBT-NS Poisoning

- [ ] Run Responder to capture hashes.
  
### SMB Relay Attacks

- [ ] Use tools like `ntlmrelayx` to perform SMB relay attacks.

### IPv6 DNS Takeover via mitm6

- [ ] Run mitm6 to perform DNS spoofing over IPv6.

### Passback Attacks

- [ ] Use tools like `Kekeo` for Ticket Relay (Passback) attacks.

---

## Post-Exploitation

- [ ] Enumerate network shares.
- [ ] Harvest passwords and hashes.
- [ ] Keylogging.
- [ ] Create backdoors.

## Data Exfiltration

- [ ] Identify valuable data.
- [ ] Use secure methods to exfiltrate data.

---

## Cleanup

- [ ] Remove all installed tools and scripts.
- [ ] Delete logs where possible.
- [ ] Restore any modified configurations to their original state.

---

## Reporting

- [ ] Document all findings.
- [ ] Provide proof of concepts.
- [ ] List recommended mitigations.
- [ ] Finalize and send the report to the client.

